<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invoker Dashboard</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
<header>
    <div class="header-left">
        <h1 data-i18n="dashboard">Dashboard</h1>
        <span id="active-supplier"></span>
    </div>
    <div class="header-right">
        <button id="create-invoice-btn" class="cta" data-i18n="create_invoice">Create Invoice</button>
        <button id="suppliers-btn" class="cta" data-i18n="switch_supplier">Switch Supplier</button>
        <button id="customers-btn" class="cta" data-i18n="customers">Customers</button>
        <div class="logout-group">
            <!-- Language Selector -->
            <div class="language-selector">
                <button class="language-globe-btn" title="Change language">üåê</button>
                <div class="language-dropdown">
                    <button data-lang="en">English</button>
                    <button data-lang="sv">Svenska</button>
                    <button data-lang="no">Norsk</button>
                    <button data-lang="da">Dansk</button>
                    <button data-lang="fr">Fran√ßais</button>
                    <button data-lang="es">Espa√±ol</button>
                    <button data-lang="de">Deutsch</button>
                    <button data-lang="it">Italiano</button>
                    <button data-lang="nl">Nederlands</button>
                    <button data-lang="pl">Polski</button>
                </div>
            </div>
            <button id="logout-btn" class="logout-btn" data-i18n="logout">Logout</button>
            <label class="theme-toggle">
                <input type="checkbox" id="theme-switch">
                <span class="slider"></span>
            </label>
        </div>
    </div>
    <div class="hamburger" id="hamburger">
        <span></span>
        <span></span>
        <span></span>
    </div>
</header>

<div class="mobile-nav" id="mobile-nav">
    <button class="mobile-nav-close" id="mobile-nav-close">√ó</button>
    <button id="mobile-create-invoice-btn" data-i18n="create_invoice">Create Invoice</button>
    <button id="mobile-suppliers-btn" data-i18n="switch_supplier">Switch Supplier</button>
    <button id="mobile-customers-btn" data-i18n="customers">Customers</button>

    <!-- Mobile language selector -->
    <div class="language-selector" style="margin: 20px 0;">
        <button class="language-globe-btn" style="font-size: 32px;">üåê</button>
        <div class="language-dropdown">
            <button data-lang="en">English</button>
            <button data-lang="sv">Svenska</button>
            <button data-lang="no">Norsk</button>
            <button data-lang="da">Dansk</button>
            <button data-lang="fr">Fran√ßais</button>
            <button data-lang="es">Espa√±ol</button>
            <button data-lang="de">Deutsch</button>
            <button data-lang="it">Italiano</button>
            <button data-lang="nl">Nederlands</button>
            <button data-lang="pl">Polski</button>
        </div>
    </div>

    <label class="theme-toggle" style="margin:20px 0;">
        <input type="checkbox" id="mobile-theme-switch">
        <span class="slider"></span>
    </label>
    <button id="mobile-logout-btn" class="logout-btn" data-i18n="logout">Logout</button>
</div>

<div class="main">
    <div class="card">
        <h2 data-i18n="analytics_overview">Analytics Overview</h2>
        <div class="analytics-grid" id="metrics-grid"></div>

        <div class="charts-grid">
            <div class="chart-container">
                <h3 data-i18n="monthly_revenue">Monthly Revenue (Billed vs Paid)</h3>
                <canvas id="revenueChart"></canvas>
            </div>
            <div class="chart-container">
                <h3 data-i18n="invoice_status_distribution">Invoice Status Distribution</h3>
                <canvas id="statusChart"></canvas>
            </div>
            <div class="chart-container">
                <h3 data-i18n="top_customers">Top 5 Customers by Revenue</h3>
                <canvas id="topCustomersChart"></canvas>
            </div>
            <div class="chart-container">
                <h3 data-i18n="receivables_aging">Receivables Aging</h3>
                <canvas id="agingChart"></canvas>
            </div>
        </div>
    </div>

    <div class="card">
        <h2 data-i18n="invoice_history">Invoice History</h2>
        <div class="filter-bar">
            <div class="filter-controls">
                <div class="filter-group">
                    <label data-i18n="search_invoice_id">Search Invoice ID</label>
                    <input type="text" id="filter-id" placeholder="e.g. INV-001">
                </div>
                <div class="filter-group">
                    <label data-i18n="customer">Customer</label>
                    <input type="text" id="filter-customer" placeholder="Customer name">
                </div>
                <div class="filter-group">
                    <label data-i18n="from_date">From Date</label>
                    <input type="date" id="filter-from">
                </div>
                <div class="filter-group">
                    <label data-i18n="to_date">To Date</label>
                    <input type="date" id="filter-to">
                </div>
                <div class="filter-group">
                    <label data-i18n="status">Status</label>
                    <select id="filter-status">
                        <option value="">All</option>
                        <option value="draft">Draft</option>
                        <option value="sent">Sent</option>
                        <option value="paid">Paid</option>
                    </select>
                </div>
                <button id="clear-filters" data-i18n="clear_filters">Clear Filters</button>
            </div>
            <button id="export-csv-btn" data-i18n="export_csv">Export Displayed to CSV</button>
        </div>

        <div class="desktop-table-wrapper">
            <table id="invoices-table" class="table">
                <thead>
                    <tr>
                        <th class="sortable" data-sort="invoice_id" data-i18n="invoice_id">Invoice ID</th>
                        <th class="sortable" data-sort="issue_date" data-i18n="date">Date</th>
                        <th data-i18n="customer">Customer</th>
                        <th class="sortable" data-sort="total_amount" data-i18n="total">Total</th>
                        <th data-i18n="currency">Currency</th>
                        <th class="sortable" data-sort="status" data-i18n="status">Status</th>
                        <th data-i18n="actions">Actions</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td colspan="8" class="no-invoices">Loading invoices...</td></tr>
                </tbody>
            </table>
        </div>

        <div class="mobile-invoice-list" id="mobile-invoice-list"></div>

        <div id="empty-state" class="empty-state" style="display:none;">
            <h3 data-i18n="no_invoices_yet">No invoices yet</h3>
            <p data-i18n="get_started_peppol">Get started by creating your first PEPPOL invoice.</p>
            <button id="empty-create-btn" class="cta" data-i18n="create_invoice">Create Invoice</button>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="assets/js/i18n.js"></script>
<script src="assets/js/main.js"></script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9ae72f4a2b8f9939',t:'MTc2NTgxNDc1MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script>
</body>
</html>
